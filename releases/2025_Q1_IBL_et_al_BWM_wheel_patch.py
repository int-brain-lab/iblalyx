eids = ['04749a70-ac63-477d-8392-d4d529184fab',
        '09156021-9a1d-4e1d-ae59-48cbde3c5d42',
        '0cf6d255-8f2f-463e-84fb-c54bacb79f51',
        '10fac7a1-919d-4ca7-83c4-4675bd8d9416',
        '14127fdb-2e66-4823-b124-f49c128ba94d',
        '1b61b7f2-a599-4e40-abd6-3e758d2c9e25',
        '1d4a7bd6-296a-48b9-b20e-bd0ac80750a5',
        '1dbba733-24a4-4400-9436-53f1bd8428e8',
        '2038e95d-64d4-4ecb-83d0-1308d3c598f8',
        '233617ec-c5cf-4eda-afc8-3b1d94f36d73',
        '2584ce3c-db10-4076-89cb-5d313138dd38',
        '283ecb4c-e529-409c-9f0a-8ea5191dcf50',
        '2ab7d2c2-bcb7-4ae6-9626-f3786c22d970',
        '30af8629-7b96-45b7-8778-374720ddbc5e',
        '36573e0b-ddd6-4504-94ec-9a23c877486c',
        '37ac03f1-9831-4a30-90fc-a59e635b98bd',
        '37bbc17f-8dec-4fa8-97fd-e23a5c6bad1f',
        '3bb54985-77b2-421d-9d1f-46185be51216',
        '4546cd60-fa2a-4d20-a9b6-d091e01d16f2',
        '49250fba-801c-4867-a0a7-a1e19538cb61',
        '500a71dd-8768-4211-a1fe-1fafc9fcbf29',
        '5437ec1f-6535-470c-80b8-4c8806ee085d',
        '58c4bf97-ec3b-45b4-9db4-d5d9515d5b00',
        '61caa69d-088b-465a-b9d0-d75341dabac6',
        '62902992-8432-46fb-af12-6392012e58c7',
        '62ff920c-2fdd-4feb-9d9f-0d66f2e595a1',
        '64977c74-9c04-437a-9ea1-50386c4996db',
        '68775ca0-b056-48d5-b6ae-a4c2a76ae48f',
        '6ab9d98c-b1e9-4574-b8fe-b9eec88097e0',
        '6bf810fd-fbeb-4eea-9ea7-b6791d002b22',
        '6cbeead9-bb7a-40e1-8ccd-47ae60239654',
        '7235b10c-6621-44ea-abe9-01559633472d',
        '75db708a-9952-4452-a5b1-a851d88f8e28',
        '7eeb8423-49e6-4d40-ab6f-703d17af231a',
        '7f150b7c-c261-46e6-9edb-cc391c9d9f03',
        '837b4e6a-ccfd-49b0-a1dd-3aa53fbf2ecb',
        '87ad026d-5b95-4022-8d59-c260870d830f',
        '8b1f4024-3d96-4ee7-95f9-8a1dfd4ce4ef',
        '90e524a2-aa63-47ce-b5b8-1b1941a1223a',
        '94dabed1-741c-4ddd-a6b7-70561e27b750',
        '98e0074c-706a-40e5-bbb5-223f97585a99',
        '9a6e127b-bb07-4be2-92e2-53dd858c2762',
        '9fc31d79-b56f-46d0-92a0-e9563caf4a7a',
        '9fcbd1a0-77e6-4c41-9428-eeaee74becd5',
        'a2b9fbbe-79fc-4166-a16e-b307813a2f06',
        'a34b4013-414b-42ed-9318-e93fbbc71e7b',
        'bd07e3a7-09c3-4b67-996b-42b6d5cedf1c',
        'be164a14-6e73-42c3-ab60-d29c48693c0f',
        'c02e5155-8e8f-427e-873d-d61490bbb9c3',
        'c16d3557-b2c1-4545-93d0-112ac0915d93',
        'c23b4118-db40-4333-af1d-933154b533c6',
        'c8e11fd8-d130-4f06-abba-9aa20240ce7c',
        'cea755db-4eee-4138-bdd6-fc23a572f5a1',
        'cef05f87-161b-4031-932c-6f47daf89698',
        'd23b005f-46f5-4fe1-870c-f55f6eb9533d',
        'd71e565d-4ddb-42df-849e-f99cfdeced52',
        'e6bdb1f4-b0bf-4451-8f23-4384f2102f91',
        'e6de6c35-1508-4471-b7c3-f12a5c7a6d39',
        'ef38e503-dd79-4185-bf87-4712d4f274fe',
        'f27e6cd6-cdd3-4524-b8e3-8146046e2a7d',
        'fbd28ea6-3251-48e0-b215-2c51ec5185f7',
        'fd03d365-91df-41e2-ad81-9e0e4b9f5c7b']

from one.api import ONE
import pandas as pd
one = ONE()

tag = one.alyx.rest('tags', 'list', name='2025_Q1_IBL_et_al_BWM_wheel_patch')[0]

dsets = one.alyx.rest('datasets', 'list', revision='2024-05-06', collection='alf', django=f'session__in,{eids}')
df_dsets = pd.DataFrame({'dataset_id': [d['url'][-36:] for d in dsets]})
df_dsets.to_parquet('/Users/olivier/Documents/PYTHON/00_IBL/iblalyx/releases/2025_Q1_IBL_et_al_BWM_wheel_patch_datasets.pqt')

for dset in dsets:
    one.alyx.rest('datasets', 'partial_update', id=dset['url'][-36:], data={'tags': ['2025_Q1_IBL_et_al_BWM_wheel_patch']})